
;;                   ___ _ __ ___   __ _  ___ ___
;;                  / _ \ '_ ` _ \ / _` |/ __/ __|
;;                 |  __/ | | | | | (_| | (__\__ \
;;                (_)___|_| |_| |_|\__,_|\___|___/
;;                               .-.
;; =--------------------------   /v\  ----------------------------=
;; = lapipaplena.org            // \\              templix@gmx.es =
;; =-----------------          /(   )\        --------------------=
;; =                            ^^-^^                             =
;; =         https://tractatuslapipaplena.herokuapp.com/          =
;; =--------------------------------------------------------------=
;
;
;;;;;; Ajustaments generals;;;;;;;;;;;;;;
;
;
;;; Algunes coses que podem implementar para l'arrencada:
;(split-window-horizontally)   ;; Iniciar con la ventana dividida es dos
;(other-window 1)              ;; Moure's al segon panel
;(shell)                       ;; Llançar-hi una shell
;(rename-buffer "shell-1")     ;; Enumerar-la com a "shell-1"
;(other-window 1)              ;; Anar novament al primer panell
;
;
;; Emacs com a servidor:
(server-start)
;
;(message "***** Entrant al meu arxiu .emacs *****")
;
;;; No mostrar els missatges d'inici. Incompatible amb message anterior
(setq inhibit-startup-message t)
;
;;; tipus de sistema
(defun insert-system-type()
(interactive)
(insert (format "%s" system-type)))
;
;;; nom del sistema
(defun insert-system-name()
(interactive)
(insert (format "%s" system-name)))
;
;;; Diferenciar lo que es texto de lo que son órdenes para el formateo del texto:
(global-font-lock-mode 1)
;
;;; Il·luminar els parentesi i les claus per parelles:
(show-paren-mode 1)
;
;;; Fer servir la decoració de text següent:
;;;(bash, la màxima  [t], latex, la mínima [1], un entremig seria valor 2
(setq font-lock-maximum-decoration
      '((shell-mode . t) (latex-mode . 2)))
;
;;; Que mostri las sortides de shell en colors:
(add-hook 'shell-mode-hook 'ansi-color-for-comint-mode-on)

;;; especificar directori per les extensions:
(add-to-list 'load-path (expand-file-name "~/.emacs.d/lisp"))
;
;;; Modus inicial per defecte
(setq default-major-mode 'text-mode)
;
;;; Donar permisos D'execució al fitxer si és un script i poder-lo
;;; executar amb C-c e
(setq after-save-hook (quote (executable-make-buffer-file-executable-if-script-p)))
;
;; Veure depuració d'scripts de manera ràpida
;;; quickrum (https://raw.github.com/syohex/emacs-quickrun/master/quickrun.el)
(require 'quickrun)
;
;;; No fer copies de seguretat ni crear arxius #auto-save#
(setq make-backup-files nil)
(setq auto-save-default nil)
;; Si volguessim copies de seguretat cada 5 minuts:
;(setq auto-save-timeout 5)
;
;;; guardar la sessió al tancar emacs i restaurar-la
;;; al arrancar-lo de nou. Posar a zero [0] per desactivar:
(desktop-save-mode 1)
;
;;; No mostrar la barra del menú
(menu-bar-mode -1)
;
;;; Amagar les contrasenyes quant les teclegem.
(add-hook 'comint-output-filter-functions 'comint-watch-for-password-prompt)
;
;;; Descomprimir arxius
(auto-compression-mode t)
;
;;; Reemplaçar "yes" y "no" per "y" y "n" en el prompt
(fset 'yes-or-no-p 'y-or-n-p)
;
;;; Confirmar per sortir d'emacs:
;(setq confirm-kill-emacs 'yes-or-no-p)
;;; Realçar la línea del focus. drecera: C-c i
;
(global-hl-line-mode 0)
(set-face-background 'hl-line "blue")
;
;;; Consultar indicador de bateria M-x display-battery-mode
;;; Activar indicador de bateria:
;(display-battery-mode 1)
;
;;; rellotge amb format 24 hores
;; Mostrar fecha y hora
;'(display-time-format "%a %x")
(setq display-time-day-and-date t
      display-time-24hr-format t)
(display-time)
;
;;; Posar en català el calendari
(setq calendar-week-start-day 1
calendar-day-name-array ["Dg" "Dl" "Dt" "Dc" "Dj" "Dv" "Ds"]
calendar-month-name-array ["Gener" "Febrer" "Març" "Abril" "Maig" "Juny" "Juliol" "Agost" "Setembre" "Octubre" "Novembre" "Decembre"])
;
;;; Afegir un espai entra el número de linia i el text de la linia:
(setq linum-format "%d ")
;
;;; Ordre en el que es mostra el buffers per la seva importancia:
(setq ido-file-extensions-order '(".txt" ".tex" ".emacs"))
;
;;; Ignorar mayúsculas en modo ido:
(setq ido-case-fold t)
;
;;; Insensible a mayúsculas y minúsculas en las busquedas:
(setq case-fold-search nil)
;
;;; Habilitar coincidencia aproximada:
(setq ido-enable-flex-matching t)
;
;;; Redimensionar el minibuffer si es torna massa gran:
(follow-mode t)
;;; Fer servir espais en contes de tabulacions:
(setq-default indent-tabs-mode nil)
;; Que les tabulacions siguin de 4 espais:
(setq tab-width 4)
;;; Eliminar espais en blanc al final de la linia automàticament al guardar l'arxiu
(add-hook 'before-save-hook 'delete-trailing-whitespace)
(add-hook 'write-file-hooks 'delete-trailing-whitespace nil t)
;
;;; Llegir també aquest arxiu d'extensió de la configuració:
(load "~/.gnu-emacs")
;
;;; Que els .emacs sobrin en lisp-mode
(add-to-list 'auto-mode-alist '("\\.emacs$" . lisp-mode)
						      '("\\.gnu-emacs$" . lisp-mode))
;
;;; Guardar historial d'arxius visitats fins i tot entre sessions:
(savehist-mode 1)
;
;;; alies per a eval-buffer:
(defalias 'eb 'eval-buffer)
;
;;; Formatar las línies d'un text a 70 espais
;;  (M-x auto-fill-mode i després clicar ESP) Per fer-ho permanent:
;(add-hook 'text-mode-hook 'turn-on-auto-fill)
;
;;; Mostrar a la línia de mode la columna al costat del número de línia:
(column-number-mode t)
;
;
;;;;;;;;; Keys;;;;;;;;;;;;;;
;;; Comentar trossos de codi:
(global-set-key (kbd "C-c c") 'comment-region)
;;; Descomentar trossos de codi:
(global-set-key (kbd "C-c u") 'uncomment-region)
;;; Anar a la linea...
(global-set-key (kbd "C-c g") 'goto-line)
;;; Obrir terminals:
(global-set-key (kbd "C-c t") 'multi-term-next)
(global-set-key (kbd "C-c T") 'multi-term) ;; Obrir nova terminal
;;; Obrir firefox:
(global-set-key (kbd "C-c f") 'browse-url-firefox)
;;; Abrir una URL de w3m al navegador extern:
(global-set-key (kbd "C-c a") 'w3m-external-view-this-url)
;;; Posar el cursor sobre una URL d'un text i obrir-la al firefox
;;; Creada la funció w3mext
(global-set-key (kbd "C-c b") 'w3mext-open-link-or-image-or-url)
;;; executar scripts:
(global-set-key (kbd "C-c e") 'executable-interpret)
;;; executar scripts amb quickrun:
(global-set-key (kbd "C-c r") 'quickrun)
;;; obrir menu dels buffers oberts:
(global-set-key (kbd "C-c m") 'buffer-menu)
;;; imprimir a ps (C-u M-x ps-print-buffer-with-faces)
;;; pasar a pdf: ps2pdf arxiu.ps arxiu.pdf
;(global-set-key (kbd "C-c i") 'ps-print-buffer-with-faces)
;;; Dreceres de teclat skeleton per a latex
;;; Resaltar la linea del foco:
(global-set-key (kbd "C-c i") 'global-hl-line-mode)
;;; skeleton dialeg:
(global-set-key (kbd "C-c d") 'dialeg)
;;; skeleton quadre:
(global-set-key (kbd "C-c q") 'quadre)
;;; skeleton argument:
(global-set-key (kbd "C-c z") 'argument)
;;; skeleton plantilla:
(global-set-key (kbd "C-c y") 'plantilla)
;;; skeleton logo:
(global-set-key (kbd "C-c l") 'logo)
;;; Obre llistat d'arxius o directoris de forma ràpida:
(global-set-key (kbd "C-c x") 'xah-open-file-fast)
;;; Crear backup del buffer actual:
(global-set-key (kbd "C-c v")'make-backup)
;;; Imprimir buffer a pdf con C-c p
(global-set-key (kbd "C-c p") 'pdf-save-buffer)
;;; Mostrar consola al pulsar F5:
(global-set-key (kbd "<f5>") 'eshell)
;;; No tallar la paraula al final de la línia, clicant F6:
(global-set-key (kbd "<f6>") 'global-visual-line-mode)
;;; Mostar/amagar números de línia amb F7 (Linum-Mode)
(global-set-key (kbd "<f7>") 'global-linum-mode)
;;; Obrir amb app externa amb F8:
(global-set-key (kbd "<f8>") 'external-app)
;;; llançar blog de notes amb F9:
(global-set-key (kbd "<f9>") 'remember)
;;;;;;;;;;;; Llançar el buffer scratch con C-c s:
(global-set-key (kbd "C-c s")
  (lambda()(interactive)(switch-to-buffer "*scratch*")))
;;;;;;;;;;;; llançar el directori .emacs.d con C-c d:
(global-set-key (kbd "C-c 1")
  (lambda()(interactive)(find-file "~/.emacs.d")))
;;; Reobrir algun dels darrers 25 buffer oberts,
;;; fins i tot els tancats:
(global-set-key (kbd "C-c 2") 'recentf-open-files)
;
;
;
;
;
;;;;;;;;;;;; Ajustaments a les extensions ;;;;;;;;;;;;
;
;
;;; blog de notes.
;;; LLançar amb M-x remember (o F9). C-c C-c per posar data i hora
;;; Crea l'arxiu ~/.notes amb totes les notes que anem posant.
;;; cd ~/.emacs.d
;;; git clone git://repo.or.cz/remember-el.git remember
(add-to-list 'load-path "~/.emacs.d/remember")
(require 'remember)
;
;
;;; Multi-term
;;; Obrir amb M-x multi-term o amb la drecera (C-c t o C-c T). Descarregar de:
;;; http://www.emacswiki.org/emacs/download/multi-term.el
(autoload 'multi-term "multi-term" nil t)
(autoload 'multi-term-next "multi-term" nil t)
(setq multi-term-program "/bin/bash")   ;; use bash
;
;
;;; package.el (emacs24)
;;; (http://repo.or.cz/w/emacs.git/blob_plain/1a0a666f941c99882093d7bd08ced15033bc3f0c:/lisp/emacs-lisp/package.el)
;;; Paquets llestos per a instal·lar (tipus apt-get). M-x package-list-packages (update) M-x list-packages (llistar)
;;; Per activar el modo: M-x package-menu-mode
(add-to-list 'load-path (expand-file-name "~/.emacs.d/package.el"))
(require 'package)
(package-initialize)
(setq package-archives '(("gnu" . "http://elpa.gnu.org/packages/")
                         ("marmalade" . "http://marmalade-repo.org/packages/")
                         ("melpa" . "http://melpa.milkbox.net/packages/")))
;
;
;;; Referent al paquet ido:
(require 'ido)
;(setq ido-enable-flex-matching t)
;(setq ido-everywhere t)
(ido-mode 'buffers)
;;; Ignorar determinats buffers perquè no surtin al pulsar C-x b
(setq ido-ignore-buffers '("^ " "*Completions*" "*Shell Command Output*"
                           "*Messages*" "Async Shell Command" "*scratch*"
                           "*tramp*"))
; Veure el llistat vertical quant es pulsa C-x b
; M-x package-install i entrar:   ido-vertical-mode el paquet està a MELPA
;(require 'ido-vertical-mode)
;(ido-mode 1)
;(ido-vertical-mode 1)
;
;
;;; Navegador
; Navegador w3m:
(setq w3m-home-page "http://google.es"
w3m-default-display-inline-images t
w3m-display-inline-image t
w3m-resize-images t
w3m-use-cookies t
w3m-cookie-accept-bad-cookies t)
;
;
;;; ssh
;;; Accés ssh (C-x C-f /ssh:usuari@IP:/home/usuari):
(require 'tramp)
(setq tramp-default-method "ssh")
;;; activar variables per veure sortida de problemes amb tramp
(setq tramp-debug-buffer t)
(setq tramp-verbose 10)
;
;
;;; sudo:
;;; Forma d'us [C-x C-f /sudo::/etc/hosts]
;;; C-x C-f /sudo:root@localhost:/etc/hosts o C-x sudo-find-file
(defun sudo-find-file (file-name)
  "Like find file, but opens the file as root."
  (interactive "FSudo Find File: ")
  (let ((tramp-file-name (cocat "/sudo::" (expand-file-name file-name))))
    (find-file tramp-file-name)))
;
;
;;; Ajustar el prompt de eshell
;;; Modificar el prompt per mostrar el directori de treball
;;; Per mostrar l'usuari: (concat (getenv "USER")
(setq eshell-prompt-function
(lambda nil
(concat (eshell/pwd)
(if (= (user-uid) 0) " # " " $ "))))
;;; fer servir bash en lloc de la shell d'emacs:
(setq shell-file-name "/bin/bash")
;;; missatge de benvinguda al entrar a la eshell:
(setq eshell-banner-message "\n... entrant a  emacs shell...\n\n")
;
;
;;; Colors:
;;; Posar esquemes de colors
(add-to-list 'load-path (expand-file-name "~/.emacs.d/lisp/color-theme/"))
(require 'color-theme)
(color-theme-initialize)
;; L'esquema de color triat:
;(color-theme-charcoal-black)
;(color-theme-calm-forest)
;(color-theme-lethe)
;(color-theme-oswald)
;(color-theme-taming-mr-arneson)
;(color-theme-jsc-dark)
;
;
;;;;; Reabrir algún buffer cerrado anteriormente
;; La drecera de teclat és C-c 2
(require 'recentf)
(recentf-mode 1)
(setq recentf-max-saved-items 200)
(setq recentf-max-menu-items 25)
(recentf-mode)
;; Limpiar listado al inicio si se visitan remotos:
; (setq recentf-auto-cleanup 'never)
;
;
;;;; Activar tomar descansos cada determinado periodo de tiempo:
;;   type-break-mode activa/desactiva la extensión
(require 'type-break)
;; Frecuencia para tomar descansos en segundos (1 hora) :
(setq type-break-interval (* 60 60))
; Para cada frecuencia anterior parar 5 minutos:
(setq type-break-good-rest-interval (* 60 5))
;
;

;;; Obrir amb apps externes amb "intro" (~/.emacs.d/openwith.el)
(require 'openwith)
(openwith-mode t)
(require 'mm-util)
(add-to-list 'mm-inhibit-file-name-handlers 'openwith-file-handler)
;
;
;;; Modo markdown
(add-to-list 'load-path "~/.emacs.d/markdown-mode")
(autoload 'markdown-mode "markdown-mode" t)
; "Major mode for editing Markdown files" t)
(add-to-list 'auto-mode-alist '("\\.markdown\\'" . markdown-mode))
(add-to-list 'auto-mode-alist '("\\.md\\'" . markdown-mode))
;
;
;;; emacs-wget (http://www.filewatcher.com/m/emacs-wget.tbz.29-1.html)
;;; Las descarrregues a ~/download
(add-to-list 'load-path (expand-file-name "~/.emacs.d/lisp/wget"))
(require 'wget)
(defvar wget-hide-status t
  "Default hide wget download window.")
;
;
;;;;;; Modo latex
;; Que quant es carregui el mode major LaTeX s'activi automàticament RefTeX.
(add-hook 'LaTeX-mode-hook 'turn-on-reftex)
;; Que AUCTeX delegui a RefTeX lo relatiu a la generació d'etiquetes.
(setq reftex-plug-into-AUCTeX t)
;; Que AUCTeX detecte el uso de include o input
(setq-default TeX-master nil)
;; Guardar automáticamente la compilación:
;(setq TeX-save-query nil)
;; Analizar el documento al guardar:
(setq TeX-auto-save t)
;; Analizar el documento al cargar:
(setq TeX-parse-self t)
;; Per a que els .tex s'obrin en latex-mode:
(add-to-list 'auto-mode-alist '("\\.tex$" . latex-mode))
;; Corregir els comentaris mentre s'escriu. No les etiquetes ni les variables:
;; M-$ per veure opcions "i" per incorporar al diccionari.
;(setq flyspell-mode t)
;;;;;;;;;;;;;;;;;;;


(setq TeX-auto-save t) ;AUCTeX detecta los .tex
(setq TeX-parse-self t)



;
;;;;;; Escoltar música amb emms:
(add-to-list 'load-path "~/.emacs.d/lips/")
(require 'emms)
(emms-standard)
(emms-default-players)
(setq emms-source-file-default-directory "~/musica_dades/")
(require 'emms-streams)
(setq emms-player-list '(emms-player-mplayer
			 emms-player-mplayer-playlist
			 emms-player-mpg321))
(define-emms-simple-player mplayer '(file url)
  (regexp-opt '(".ogg" ".mp3" ".wav" ".mpg" ".mpeg" ".wmv" ".wma"
		".mov" ".avi" ".divx" ".ogm" ".asf" ".mkv" "http://" "mms://"
		".rm" ".rmvb" ".mp4" ".flac" ".vob" ".m4a" ".flv" ".ogv" ".pls"))
        "mplayer" "-slave" "-quiet" "-really-quiet" "-fullscreen")
;
;
;;;;;;;;; FI PRIMERA PART... CONTINUA A ~/.gnu-emacs ;;;;;;;;;;;
;
;(setq frame-title-format '("" "%b @ Emacs " emacs-version))
;
